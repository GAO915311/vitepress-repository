# 方法论

## 0-1 背包

有编号为 $[0-i]$ 的物品，每个物品的重量为 $w[i]$，价值为 $v[i]$。注意：$[0-i]$ 就是子问题的规模。

状态：$[0-i]$ 中任意物品组合装入容量最大为 $j$ 的背包（可以装不满）的最大价值。

决策：$dp[i][j]=\mathrm{max}\big\{dp[i-1][j],\ dp[i-1][j-w[i]]+v[i]\big\}$。

## 完全背包

|     |      |              |     |
| :-- | :--: | :----------- | --- |
|     |      |              |     |
|     | 279  | 完全平方数        |     |
|     | 322  | 零钱兑换         |     |
|     | 416  | 分割等和子集       |     |
|     | 474  | 一和零          |     |
|     | 494  | 目标和          |     |
|     | 518  | 零钱兑换 II      |     |
|     | 879  | 盈利计划         |     |
|     | 1049 | 最后一块石头的重量 II |     |
|     | 1155 | 掷骰子的 N 种方法   |     |
|     |      |              |     |

# 题目

## 416. 分割等和子集

这里的 $w[i]$ 与 $v[i]$ 相等，背包的最大价值是数组和的一半。

## 474. 一和零

多维度背包问题，背包的维度有两个。

## LC 879. 盈利计划

决策和状态定义：$dp[i][j][k]$ 定义为 $[0-i]$ （前 $i$ 个工作中）选择了 $j$ 个员工完成了最少 $k$ 个利润的方案数。

思考：员工数就是背包容量，重量就是 $j$。

注意点 1：$k$ 维度利润最少如何转移。本次盈利为 $earn$，至少要达到 $k$ 个盈利，上一次的盈利只需要 $\mathrm{max}(0, k-earn)$。

注意点2：要不要对 $j$ 维度求和取决于对 $dp[i][j][k]$ 的定义。
- $dp[i][j][k]$ 定义为 $[0-i]$ （前 $i$ 个工作中）==最多==选择了 $j$ 个员工（背包可以装不满）完成了最少 $k$ 个利润的方案数。
- $dp[i][j][k]$ 定义为 $[0-i]$ （前 $i$ 个工作中）==刚好==选择了 $j$ 个员工（背包刚好装满）完成了最少 $k$ 个利润的方案数。

对于第一种情况，初始化 $dp[0][j][0]=1$ （没有物品且背包重量为 0 时，对于所有的员工，方案数都是 1）。

对于第二种情况，初始化 $dp[0][0][0]=1$。



作为对比，494. 目标和的初始化就和上述的第二种情况一致，状态定义为：$[0-i]$ 的物品放入容量为 $j$ 的背包刚好装满的方案数。

二维数组中，只能初始化 $dp[0][0]=0$，不能直接初始化 $dp[i][0]=0$。
## 完全背包问题

具体的公式推导
$$
dp[i][j]=\mathrm{max}\left\{dp[i-1][j],\ dp[{\color{red}i}][j-w[i]]+v[i]\right\}
$$
上式第二项 $dp[i][j-w[i]]+v[i]$ 可以理解为：**背包中至少有了一个物品 $i$，再加一个物品 $i$ 的情况**。

这里注意区别。
$$
dp[i][j]=\mathrm{max}\left\{dp[i-1][j],\ \mathrm{dp}[{\color{red}i-1}][j-w[i]]+v[i]\right\}
$$
完全背包问题的公式推导，这里的推导第二项是具有递推的性质。
```LaTeX
dp[i][j] = max {
	dp[i - 1][j - 0x] + 0y, 
	dp[i - 1][j - 1x] + 1y, 
	dp[i - 1][j - 2x] + 2y
}

dp[i][j - 1x] = max {
	dp[i - 1][j - 1x - 0x] + 0y,
	dp[i - 1][j - 1x - 1x] + 1y
}

第二个维度出现了递推，第一个维度就不变，可以根据递推计算差值（这里是 y）。
```
$$
dp[i][j]=\mathrm{max}\{dp[i-1][j],\ dp[i-1][j-w[i]]+v[i],\\dp[i-1][j-2*w[i]]+2*v[i]\ \dots\ dp[i-1][j-k*w[i]]+k*v[i]\}\quad 0 \leq k*w[i]\leq j
$$
将物品 $i$ 排除在外的情况
$$
\begin{array}{c}
dp[i][j-w[i]]=\mathrm{max}\{dp[i-1][j-w[i]],\ dp[i-1][j-2*w[i]]+v[i],\
dp[i-1][j-3*w[i]]+v[i],\ \dots\\\
dp[i-1][j-k*w[i]]+(k-1)*v[i]\} \quad w[i] \leq k*w[i]\leq j
\end{array}
$$
$i - 1$ 这个维度没变，后面 $k$ 项相差了一个 $v[i]$，将第二个公式代入第一个公式可得
$$
dp[i][j]=\mathrm{max}\left\{dp[i-1][j],\ \mathrm{dp}[i][j-w[i]]+v[i]\right\}
$$
就是这个维度，0-1 背包问题。就是这个维度，0-1 背包问题。状态从左上方和正上方转移而来。

# 总结

遍历顺序：
- 0-1 背包问题：状态从**左上方和正上方**转移而来，一维数组**反向遍历**。
- 完全背包问题：状态从**左方和正上方**转移而来，一维数组**正向遍历**。

组合数和排列数：
- 一般的情况，先遍历背包，后遍历物品，求出来的时组合数。
- 先遍历物品，后遍历背包，求出来的时排列数。
## 背包问题总结

状态定义和决策：最值问题（最大值和最小值），方案数问题，存在问题（Boolean），排列组合问题。

遍历顺序
